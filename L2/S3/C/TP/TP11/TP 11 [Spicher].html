<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" dir="ltr" lang="fr"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>
    TP 11    [Spicher]
  </title>

  <meta name="generator" content="DokuWiki Release 2009-12-25c &quot;Lemming&quot;">
<meta name="robots" content="noindex,nofollow">
<meta name="date" content="2015-11-25T17:06:38+0100">
<meta name="keywords" content="l2info,progc,tp11">
<link rel="search" type="application/opensearchdescription+xml" href="http://www.lacl.fr/%7Easpicher/Wiki/lib/exe/opensearch.php" title="Spicher">
<link rel="start" href="http://www.lacl.fr/%7Easpicher/Wiki/">
<link rel="alternate" type="application/rss+xml" title="Recent Changes" href="http://www.lacl.fr/%7Easpicher/Wiki/feed.php">
<link rel="alternate" type="application/rss+xml" title="Current Namespace" href="http://www.lacl.fr/%7Easpicher/Wiki/feed.php?mode=list&amp;ns=l2info:progc">
<link rel="alternate" type="text/html" title="Plain HTML" href="http://www.lacl.fr/%7Easpicher/Wiki/_export/xhtml/l2info/progc/tp11">
<link rel="canonical" href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp11">
<link rel="stylesheet" media="all" type="text/css" href="TP%2011%20%5BSpicher%5D_files/css_002.css">
<link rel="stylesheet" media="screen" type="text/css" href="TP%2011%20%5BSpicher%5D_files/css.css">
<link rel="stylesheet" media="print" type="text/css" href="TP%2011%20%5BSpicher%5D_files/css_003.css">
<script type="text/javascript" charset="utf-8"><!--//--><![CDATA[//><!--
var NS='l2info:progc';var SIG=' --- //[[antoine.spicher@u-pec.fr|L2 Informatique]] 2015/11/29 18:36//';var JSINFO = {"id":"l2info:progc:tp11","namespace":"l2info:progc"};
//--><!]]></script>
<script type="text/javascript" charset="utf-8" src="TP%2011%20%5BSpicher%5D_files/js.php"></script>

  <link rel="shortcut icon" href="http://www.lacl.fr/%7Easpicher/Wiki/lib/tpl/default/images/favicon.ico">

  </head>

<body>
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp11?do=backlink" title="Liens vers cette page">TP 11</a>]]
      </div>
      <div class="logo">
        <a href="http://www.lacl.fr/%7Easpicher/Wiki/" name="dokuwiki__top" id="dokuwiki__top" accesskey="h" title="[H]">Spicher</a>      </div>

      <div class="clearer"></div>
    </div>

    
    <div class="bar" id="bar__top">
      <div class="bar-left" id="bar__topleft">
                      </div>

      <div class="bar-right" id="bar__topright">
                &nbsp;
      </div>

      <div class="clearer"></div>
    </div>

        <div class="breadcrumbs">
      <span class="bchead">Piste:</span> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp1" class="breadcrumbs" title="l2info:progc:tp1">TP 1</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp2" class="breadcrumbs" title="l2info:progc:tp2">TP 2</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp3" class="breadcrumbs" title="l2info:progc:tp3">TP 3</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp4" class="breadcrumbs" title="l2info:progc:tp4">TP 4</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp5note" class="breadcrumbs" title="l2info:progc:tp5note">TP 5</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp6" class="breadcrumbs" title="l2info:progc:tp6">TP 6</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp7" class="breadcrumbs" title="l2info:progc:tp7">TP 7</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp8" class="breadcrumbs" title="l2info:progc:tp8">TP 8</a> <span class="bcsep">»</span> <a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp9" class="breadcrumbs" title="l2info:progc:tp9">TP 9/10</a> <span class="bcsep">»</span> <span class="curid"><a href="http://www.lacl.fr/%7Easpicher/Wiki/l2info/progc/tp11" class="breadcrumbs" title="l2info:progc:tp11">TP 11</a></span>          </div>
    
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <!-- TOC START -->
<div class="toc">
<div style="cursor: pointer;" class="tocheader toctoggle" id="toc__header"><span class="toc_close" style="cursor: pointer;" id="toc__toggle"><span>−</span></span>Table des matières</div>
<div id="toc__inside">

<ul class="toc">
<li class="level1"><div class="li"><span class="li"><a href="#tp_11" class="toc">TP 11</a></span></div>
<ul class="toc">
<li class="level2"><div class="li"><span class="li"><a href="#desciption_du_type" class="toc">Desciption du type</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#importexport_d_images_aux_formats_pbm_pgm_et_ppm" class="toc">Import/export d'images aux formats PBM, PGM et PPM</a></span></div></li>
<li class="level2"><div class="li"><span class="li"><a href="#manipulation_d_images" class="toc">Manipulation d'images</a></span></div></li></ul>
</li></ul>
</div>
</div>
<!-- TOC END -->



<h1><a name="tp_11" id="tp_11">TP 11</a></h1>
<div class="level1">

<p>

Dans ce TP, vous devez élabrer une bibliothèque de manipulation d'images. L'objectif est double :
</p>
<ol>
<li class="level1"><div class="li"> programmer les fonctions spécifiquent à la manipulation des images ainsi que les fonctions d'entrée/sortie</div>
</li>
<li class="level1"><div class="li"> organiser vos fichiers sources et les compiler à l'aide d'un <code>Makefile</code> ; vous aurez ici typiquement 3 fichiers :</div>
<ul>
<li class="level2"><div class="li"> <code>image.h</code> qui contient la description du type pour la représentation des images et les prototypes des fonctions demandées</div>
</li>
<li class="level2"><div class="li"> <code>image.c</code> qui contient les définitions des fonctions demandées et tout le nécessaire pour que ces définitions fonctionnent correctement</div>
</li>
<li class="level2"><div class="li"> <code>main.c</code> qui contient un programme principal permettant de tester les fonctions de votre bibliothèque</div>
</li>
</ul>
</li>
</ol>

</div>

<h2><a name="desciption_du_type" id="desciption_du_type">Desciption du type</a></h2>
<div class="level2">

<p>

Une image est un tableau à 2 dimensions d'éléments appelés <em>pixels</em>, de taille <img src="TP%2011%20%5BSpicher%5D_files/fetch_004.png" class="latex_inline" alt="$w \times h$" title="Math"> où <img src="TP%2011%20%5BSpicher%5D_files/fetch.png" class="latex_inline" alt="$w$" title="Math"> représente sa largeur (<em>width</em> en anglais), càd le nombre de pixel par ligne, et <img src="TP%2011%20%5BSpicher%5D_files/fetch_008.png" class="latex_inline" alt="$h$" title="Math"> sa hauteur (<em>height</em> en anglais), càd le nombre de lignes. Ainsi une image est composée de <img src="TP%2011%20%5BSpicher%5D_files/fetch_011.png" class="latex_inline" alt="$hw$" title="Math"> pixel.
</p>

<p>
Un pixel contient une information de couleur qui devra être générée par 
l'écran au moment de l'affichage. Cette information est séparée en 4 
parties <img src="TP%2011%20%5BSpicher%5D_files/fetch_007.png" class="latex_inline" alt="$(R,G,B,\alpha)$" title="Math"> appelées <em>canaux</em> :
</p>
<ul>
<li class="level1"><div class="li"> <img src="TP%2011%20%5BSpicher%5D_files/fetch_003.png" class="latex_inline" alt="$R$" title="Math"> (pour <em>Red</em>) : composante rouge de la couleur</div>
</li>
<li class="level1"><div class="li"> <img src="TP%2011%20%5BSpicher%5D_files/fetch_010.png" class="latex_inline" alt="$G$" title="Math"> (pour <em>Green</em>) : composante verte de la couleur</div>
</li>
<li class="level1"><div class="li"> <img src="TP%2011%20%5BSpicher%5D_files/fetch_002.png" class="latex_inline" alt="$B$" title="Math"> (pour <em>Blue</em>) : composante bleue de la couleur</div>
</li>
<li class="level1"><div class="li"> <img src="TP%2011%20%5BSpicher%5D_files/fetch_006.png" class="latex_inline" alt="$\alpha$" title="Math"> : transparence du pixel</div>
</li>
</ul>

<p>
Ces quatre informations prennent leurs valeurs dans l'intervalle <img src="TP%2011%20%5BSpicher%5D_files/fetch_012.png" class="latex_inline" alt="$[0,1]$" title="Math"> ; il est d'usage de représenter cette valeur par un entier non-signé sur 8 bits (<em>i.e.</em>, un octet) dont la correspondance sera obtenue en multipliant ou en divisant par 255.

</p>
<ul>
<li class="level1"><div class="li"> Créer le type <code>image</code> permettant de représenter une image telle que décrite ci-dessus</div>
</li>
<li class="level1"><div class="li"> Afin de faciliter les tests, définir la fonction <code>void ascii_print(image* im, channel_t cl, const char* ct)</code> qui affiche en <acronym title="American Standard Code for Information Interchange">ASCII</acronym> art l'image <code>im</code> donnée en paramètre ; le type <code>canal_t</code> est défini par <pre class="code c"><span class="kw4">typedef</span> <span class="kw2">enum</span> <span class="br0">{</span> R<span class="sy0">,</span> G<span class="sy0">,</span> B<span class="sy0">,</span> A <span class="br0">}</span> channel_t<span class="sy0">;</span></pre>

<p>
 et correspond au canal à afficher ; la chaîne de caractères <code>ct</code> servira de palette : si <code>ct</code> est de taille <img src="TP%2011%20%5BSpicher%5D_files/fetch_009.png" class="latex_inline" alt="$n$" title="Math"> et que pour un certain pixel le canal <code>cl</code> à pour valeur <img src="TP%2011%20%5BSpicher%5D_files/fetch_005.png" class="latex_inline" alt="$v$" title="Math">, le caractère à afficher pour ce pixel sera <code>ct[(strlen(ct) * </code><img src="TP%2011%20%5BSpicher%5D_files/fetch_005.png" class="latex_inline" alt="$v$" title="Math"><code>) / 255]</code>
</p>
</div>
</li>
</ul>

</div>

<h2><a name="importexport_d_images_aux_formats_pbm_pgm_et_ppm" id="importexport_d_images_aux_formats_pbm_pgm_et_ppm">Import/export d'images aux formats PBM, PGM et PPM</a></h2>
<div class="level2">

<p>

Les formats PBM, PGM et PPM sont parmi les plus simples pour stocker une
 image dans un fichier. Ils sont bien décrits sur le page <a href="https://fr.wikipedia.org/wiki/Portable_pixmap" class="urlextern" title="https://fr.wikipedia.org/wiki/Portable_pixmap" rel="nofollow">Wikipédia</a> (mais préférez la <a href="https://en.wikipedia.org/wiki/Netpbm_format" class="urlextern" title="https://en.wikipedia.org/wiki/Netpbm_format" rel="nofollow">page anglaise</a> qui est plus exhaustive). Comprenez ce format et définissez les fonctions suivantes :

</p>
<ul>
<li class="level1"><div class="li"> <code>image* load_image(const char* fname)</code>: chargement d'une image à partir d'un fichier de nom <code>fname</code> ; la fonction renverra <code>NULL</code> en cas d'échec</div>
</li>
<li class="level1"><div class="li"> <code>bool save_image(const char* fname, image* im, const char* magic_number)</code>: sauvegarde de l'image <code>im</code> dans le fichier de nom <code>fname</code> (l'ancien fichier est écrasé) au format déterminé par le nombre magique <code>magic_number</code> ; la fonction renverra si l'opération a réussi ou non</div>
</li>
</ul>

</div>

<h2><a name="manipulation_d_images" id="manipulation_d_images">Manipulation d'images</a></h2>
<div class="level2">

<p>

La bibliothèque devra permettre d'effectuer quelques operations de manipulation d'images :

</p>
<ul>
<li class="level1"><div class="li"> <code>bool grayscale(image* im)</code> : convertit l'image <code>im</code> en nuance de gris ; la page <a href="https://fr.wikipedia.org/wiki/Niveau_de_gris" class="urlextern" title="https://fr.wikipedia.org/wiki/Niveau_de_gris" rel="nofollow">Wikipédia</a> explique l'opération à appliquer</div>
</li>
<li class="level1"><div class="li"> <code>bool hflip(image* im)</code> : inverse l'image horizontalement ; en cas d'échec la fonction retourne <code>false</code> et ne modifie pas l'image d'origine <code>im</code></div>
</li>
<li class="level1"><div class="li"> <code>bool vflip(image* im)</code> : inverse l'image verticalement ; en cas d'échec la fonction retourne <code>false</code> et ne modifie pas l'image d'origine <code>im</code></div>
</li>
<li class="level1"><div class="li"> <code>bool crop(image* im, unsigned int i, unsigned int j, unsigned int w, unsigned int h)</code> : restreint une image à une sous-image de taille <code>w x h</code> ayant comme coin supérieur gauche le pixel de coordonnées <code>(i,j)</code>
 ; la fonction devra échouer si les spécfications sont incohérentes avec
 la taille de l'image d'origine ; en cas d'échec la fonction retourne <code>false</code> et ne modifie pas l'image d'orgine <code>im</code></div>
</li>
<li class="level1"><div class="li"> <code>bool resize(image* im, unsigned int w, unsigned int h)</code> : redimensionne l'image pour qu'elle respecte la nouvelle taille <code>w x h</code>
 spécifiée en arguments ; pour simplifier l'opératon (qui est moins 
triviale qu'on ne pourrait le penser de prime abord), la fonction 
n'acceptera que des tailles multiples ou diviseurs de la taille 
originale : en cas de sur-échantillonnage (nouvelle taille multiple de 
l'ancienne et donc plus grande) le pixel sera dupliqué, en cas de 
sous-échantillonage (nouvelle taille diviseur de l'ancienne et donc plus
 petite) une moyenne entre les pixels sera calculée ; la fonction devra 
autoriser un sur-échantillonnage sur la largeur et un 
sous-échantillonnage sur la hauteur (ou vice-versa) ; en cas d'échec la 
fonction retourne <code>false</code> et ne modifie pas l'image d'orgine <code>im</code></div>
</li>
</ul>



</div>

    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
        Connecté en tant que : L2 Informatique (l2info)      </div>
      <div class="doc">
        l2info/progc/tp11.txt · Dernière modification: 2015/11/25 17:06 par aspicher      </div>
    </div>

   
    <div class="bar" id="bar__bottom">
      <div class="bar-left" id="bar__bottomleft">
                              </div>
      <div class="bar-right" id="bar__bottomright">
                                        <form class="button btn_logout" method="get" action="/~aspicher/Wiki/l2info/progc/tp11"><div class="no"><input name="do" value="logout" type="hidden"><input name="sectok" value="82424b0788480fc2ae883d95f50cf65a" type="hidden"><input value="Déconnexion" class="button" title="Déconnexion" type="submit"></div></form>                <a class="nolink" href="#dokuwiki__top"><input class="button" value="Haut de page" onclick="window.scrollTo(0, 0)" title="Haut de page" type="button"></a>&nbsp;
      </div>
      <div class="clearer"></div>
    </div>

  </div>

  <div class="license">Sauf mention contraire, le contenu de ce wiki est placé sous la licence suivante:<a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></div>
</div>

<div class="footerinc">

  <a href="http://www.lacl.fr/%7Easpicher/Wiki/feed.php" title="Recent changes RSS feed"><img src="TP%2011%20%5BSpicher%5D_files/button-rss.png" alt="Recent changes RSS feed" height="15" width="80"></a>

        <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" title="CC Attribution-Noncommercial-Share Alike 3.0 Unported"><img src="TP%2011%20%5BSpicher%5D_files/cc-by-nc-sa.png" alt="" height="15" width="80"></a>
  
  <a href="http://www.dokuwiki.org/donate" title="Donate"><img src="TP%2011%20%5BSpicher%5D_files/button-donate.gif" alt="Donate" height="15" width="80"></a>

  <a href="http://www.php.net/" title="Powered by PHP"><img src="TP%2011%20%5BSpicher%5D_files/button-php.gif" alt="Powered by PHP" height="15" width="80"></a>

  <a href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="TP%2011%20%5BSpicher%5D_files/button-xhtml.png" alt="Valid XHTML 1.0" height="15" width="80"></a>

  <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3" title="Valid CSS"><img src="TP%2011%20%5BSpicher%5D_files/button-css.png" alt="Valid CSS" height="15" width="80"></a>

  <a href="http://dokuwiki.org/" title="Driven by DokuWiki"><img src="TP%2011%20%5BSpicher%5D_files/button-dw.png" alt="Driven by DokuWiki" height="15" width="80"></a>



</div>

<div class="no"><img src="TP%2011%20%5BSpicher%5D_files/indexer.gif" alt="" height="1" width="1"></div>


</body></html>